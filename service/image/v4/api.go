// Code generated by lark suite oapi sdk gen
package v4

import (
	"github.com/larksuite/oapi-sdk-go/api"
	"github.com/larksuite/oapi-sdk-go/api/core/request"
	"github.com/larksuite/oapi-sdk-go/core"
	"github.com/larksuite/oapi-sdk-go/core/config"
	"io"
	"path"
)

const serviceBasePath = "image/v4"

type Service struct {
	conf     *config.Config
	basePath string
	Images   *ImageService
}

func NewService(conf *config.Config) *Service {
	s := &Service{
		conf:     conf,
		basePath: serviceBasePath,
	}
	s.Images = newImageService(s)
	return s
}

type ImageService struct {
	service *Service
}

func newImageService(service *Service) *ImageService {
	return &ImageService{
		service: service,
	}
}

type ImagePutReqCall struct {
	ctx    *core.Context
	images *ImageService
	body   *request.FormData
	optFns []request.OptFn
}

func (rc *ImagePutReqCall) SetImage(image *request.File) {
	rc.body.AddFile("image", image)
}
func (rc *ImagePutReqCall) SetImageType(imageType string) {
	rc.body.AddParam("image_type", imageType)
}
func (rc *ImagePutReqCall) Do() (*Image, error) {
	httpPath := path.Join(rc.images.service.basePath, "put")
	var result = &Image{}
	req := request.NewRequest(httpPath, "POST",
		[]request.AccessTokenType{request.AccessTokenTypeTenant}, rc.body, result, rc.optFns...)
	err := api.Send(rc.ctx, rc.images.service.conf, req)
	return result, err
}

func (images *ImageService) Put(ctx *core.Context, optFns ...request.OptFn) *ImagePutReqCall {
	return &ImagePutReqCall{
		ctx:    ctx,
		images: images,
		body:   request.NewFormData(),
		optFns: optFns,
	}
}

type ImageGetReqCall struct {
	ctx    *core.Context
	images *ImageService

	queryParams map[string]interface{}
	optFns      []request.OptFn
	result      io.Writer
}

func (rc *ImageGetReqCall) SetImageKey(imageKey string) {
	rc.queryParams["image_key"] = imageKey
}
func (rc *ImageGetReqCall) SetResponseStream(result io.Writer) {
	rc.result = result
}
func (rc *ImageGetReqCall) Do() (io.Writer, error) {
	httpPath := path.Join(rc.images.service.basePath, "get")
	rc.optFns = append(rc.optFns, request.SetQueryParams(rc.queryParams))
	rc.optFns = append(rc.optFns, request.SetResponseStream())
	req := request.NewRequest(httpPath, "GET",
		[]request.AccessTokenType{request.AccessTokenTypeTenant}, nil, rc.result, rc.optFns...)
	err := api.Send(rc.ctx, rc.images.service.conf, req)
	return rc.result, err
}

func (images *ImageService) Get(ctx *core.Context, optFns ...request.OptFn) *ImageGetReqCall {
	return &ImageGetReqCall{
		ctx:         ctx,
		images:      images,
		queryParams: map[string]interface{}{},
		optFns:      optFns,
	}
}
